{"ast":null,"code":"import * as THREE from 'three';\nimport * as dat from 'dat.gui';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\nimport Sphere from './Sphere';\nimport Light from './Light';\nimport ParticleSystem from './ParticleSystem';\nimport Movers from './Movers';\nimport PostProcessing from './PostProcessing';\nconst FOV = 100;\nconst NEAR = 0.1;\nconst FAR = 1000;\nconst margin = 200;\n\nclass World {\n  constructor() {\n    this.scene = new THREE.Scene();\n    this.camera = new THREE.PerspectiveCamera(FOV, window.innerWidth / (window.innerHeight - margin), NEAR, FAR);\n    this.cubeCamera = new THREE.CubeCamera(1, 1000, 256);\n    this.renderer = new THREE.WebGLRenderer({\n      antialias: true,\n      alpha: true\n    });\n    this.sphere = new Sphere();\n    this.particleSystem = new ParticleSystem();\n    this.movers = new Movers();\n    this.light = new Light();\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n    this.postProcessor = new PostProcessing(this.scene, this.camera, this.renderer);\n  }\n\n}\n\nWorld.prototype.listenForResize = function () {\n  window.addEventListener('resize', () => {\n    this.camera.aspect = window.innerWidth / (window.innerHeight - margin);\n    this.camera.updateProjectionMatrix();\n    this.postProcessor.setSize();\n  });\n};\n\nWorld.prototype.setUpMeshes = async function () {\n  const ambientLight = new THREE.AmbientLight(0x333333);\n  this.scene.add(ambientLight);\n  const directionalLight = new THREE.DirectionalLight(0xfafafa, 0.7);\n  directionalLight.position.set(0, 10, 5);\n  this.scene.add(directionalLight);\n  this.sphere.setLights(this.light);\n  await this.sphere.initMesh();\n  this.scene.add(this.sphere.mesh); // this.sphere.mesh.layers.disableAll();\n  // this.sphere.mesh.layers.enable(0);\n  // this.sphere.mesh.layers.enable(1);\n\n  await this.particleSystem.init();\n  this.scene.add(this.particleSystem.mesh); // this.particleSystem.mesh.layers.disableAll();\n  // this.particleSystem.mesh.layers.enable(1);\n\n  await this.movers.init(this.cubeCamera);\n  this.movers.array.forEach(mover => this.scene.add(mover.mesh));\n};\n\nWorld.prototype.init = async function () {\n  this.renderer.setPixelRatio(window.devicePixelRatio);\n  this.renderer.setClearColor(new THREE.Color('#fadadd'), 1.0);\n  this.camera.position.z = 20;\n  this.camera.position.y = 0;\n  this.cubeCamera.position.copy(this.camera);\n  this.setUpMeshes();\n  this.setUpGui();\n  this.postProcessor.setSize();\n  this.postProcessor.applyBloom();\n  this.listenForResize();\n  this.postProcessor.init(this.cubeCamera); // this.postProcessor.applyBloom();\n\n  document.body.appendChild(this.renderer.domElement);\n};\n\nWorld.prototype.start = function () {\n  this.renderer.setAnimationLoop(() => {\n    const time = Date.now() * 0.001;\n    this.sphere.animate();\n    this.movers.animate(time);\n    this.particleSystem.animate();\n    this.postProcessor.render();\n  });\n};\n\nWorld.prototype.setUpGui = function () {\n  const gui = new dat.GUI();\n  this.light.setGui(gui);\n  this.sphere.setGui(gui);\n};\n\nexport default World;","map":{"version":3,"sources":["/Users/alexiaperesson/webgl-things/src/classes/World.js"],"names":["THREE","dat","OrbitControls","Sphere","Light","ParticleSystem","Movers","PostProcessing","FOV","NEAR","FAR","margin","World","constructor","scene","Scene","camera","PerspectiveCamera","window","innerWidth","innerHeight","cubeCamera","CubeCamera","renderer","WebGLRenderer","antialias","alpha","sphere","particleSystem","movers","light","controls","domElement","postProcessor","prototype","listenForResize","addEventListener","aspect","updateProjectionMatrix","setSize","setUpMeshes","ambientLight","AmbientLight","add","directionalLight","DirectionalLight","position","set","setLights","initMesh","mesh","init","array","forEach","mover","setPixelRatio","devicePixelRatio","setClearColor","Color","z","y","copy","setUpGui","applyBloom","document","body","appendChild","start","setAnimationLoop","time","Date","now","animate","render","gui","GUI","setGui"],"mappings":"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","sourcesContent":["import * as THREE from 'three';\nimport * as dat from 'dat.gui';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\n\nimport Sphere from './Sphere';\nimport Light from './Light';\nimport ParticleSystem from './ParticleSystem';\nimport Movers from './Movers';\nimport PostProcessing from './PostProcessing';\n\nconst FOV   = 100;\nconst NEAR  = 0.1;\nconst FAR   = 1000;\nconst margin = 200\n\nclass World {\n    constructor() {\n        this.scene  = new THREE.Scene();\n        this.camera = new THREE.PerspectiveCamera(FOV, window.innerWidth / (window.innerHeight - margin), NEAR, FAR);\n        this.cubeCamera = new THREE.CubeCamera(1, 1000, 256);\n        this.renderer = new THREE.WebGLRenderer({antialias: true, alpha: true});\n       \n        this.sphere = new Sphere();\n        this.particleSystem = new ParticleSystem();\n        this.movers = new Movers();\n        this.light = new Light();\n\n        this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n        this.postProcessor = new PostProcessing(this.scene, this.camera, this.renderer)\n    } \n}\n\nWorld.prototype.listenForResize = function() {\n    window.addEventListener('resize', () => {\n        this.camera.aspect = window.innerWidth / (window.innerHeight - margin);\n        this.camera.updateProjectionMatrix();\n        this.postProcessor.setSize();\n    })\n}\n\nWorld.prototype.setUpMeshes = async function() {\n\n    const ambientLight = new THREE.AmbientLight(0x333333);\n    this.scene.add(ambientLight);\n\n    const directionalLight = new THREE.DirectionalLight(0xfafafa, 0.7);\n    directionalLight.position.set(0, 10, 5);\n    this.scene.add(directionalLight);\n\n    this.sphere.setLights(this.light);\n    await this.sphere.initMesh();\n    this.scene.add(this.sphere.mesh);\n    // this.sphere.mesh.layers.disableAll();\n    // this.sphere.mesh.layers.enable(0);\n    // this.sphere.mesh.layers.enable(1);\n\n    await this.particleSystem.init();\n    this.scene.add(this.particleSystem.mesh);\n    // this.particleSystem.mesh.layers.disableAll();\n    // this.particleSystem.mesh.layers.enable(1);\n\n\n    await this.movers.init(this.cubeCamera);\n    this.movers.array.forEach(mover => this.scene.add(mover.mesh))\n\n    \n\n}\n\nWorld.prototype.init = async function() { \n    this.renderer.setPixelRatio( window.devicePixelRatio );\n    this.renderer.setClearColor(new THREE.Color('#fadadd'), 1.0);\n\n    this.camera.position.z = 20;\n    this.camera.position.y = 0;\n    this.cubeCamera.position.copy(this.camera)\n\n    this.setUpMeshes();\n    this.setUpGui();\n\n    this.postProcessor.setSize();\n    this.postProcessor.applyBloom();\n    this.listenForResize();\n\n    this.postProcessor.init(this.cubeCamera);\n    // this.postProcessor.applyBloom();\n    \n    document.body.appendChild(this.renderer.domElement);\n}\n\nWorld.prototype.start = function() {\n    this.renderer.setAnimationLoop(\n        () => {\n            const time = Date.now() * 0.001;\n            this.sphere.animate();\n            this.movers.animate(time);\n            this.particleSystem.animate();\n            this.postProcessor.render();\n        }\n    )\n}\n\nWorld.prototype.setUpGui = function() {\n    const gui = new dat.GUI();\n    this.light.setGui(gui);\n    this.sphere.setGui(gui);\n}\n\nexport default World;"]},"metadata":{},"sourceType":"module"}